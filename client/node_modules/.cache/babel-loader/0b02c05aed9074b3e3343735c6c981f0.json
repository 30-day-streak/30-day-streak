{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import axios from'axios';import'../challenges/Challenges.css';var OneReward=/*#__PURE__*/function(_Component){_inherits(OneReward,_Component);var _super=_createSuper(OneReward);function OneReward(){var _this;_classCallCheck(this,OneReward);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={favorite:''};_this.toggleFavorite=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var newFavorite,rewardID,updatedUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;newFavorite=!_this.state.favorite;// 1. via Apps.js\n// this.props.toggleFavoriteReward(this.props.reward._id, newFavorite);\n_this.setState({favorite:newFavorite});// 2. the way it's done with challenges / different route\nrewardID=_this.props.reward._id;// 3. toggleFavoriteReward but moved from App.js\n// const updatedUser = this.props.user;\n// console.log('newFavorite', newFavorite)\n// console.log('user', updatedUser.rewards)\n// if (newFavorite) updatedUser.rewards.push(this.props.reward._id);\n// else {\n//   updatedUser.rewards = updatedUser.rewards.filter(profileRewardId => {\n//     console.log(profileRewardId._id, this.props.reward._id, profileRewardId._id !== this.props.reward._id)\n//     return profileRewardId._id !== this.props.reward._id\n//   });\n//   console.log('updated user', updatedUser.rewards)\n//   // updatedUser.rewards.pop(this.props.reward._id);\n// }\n// this.props.setUser(updatedUser);\n// axios.put(`/users/${updatedUser._id}`, {\n//   rewards: updatedUser.rewards\n// })\n//update state\n_context.next=6;return axios.put(\"/api/users/\".concat(rewardID,\"/rewardsfavorite\"),{favorite:newFavorite});case 6:updatedUser=_context.sent;console.log('udpatedUser',updatedUser.data);_this.props.setUser(updatedUser.data);console.log('user after set new user',_this.props.user);// refresh data\n_this.props.getData();_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));_this.initialSetUp=function(){var foundInUserFavorites=_this.props.user.rewards.some(function(reward){return reward._id===_this.props.reward._id;});_this.setState({favorite:foundInUserFavorites});};return _this;}_createClass(OneReward,[{key:\"componentDidMount\",value:function componentDidMount(){this.initialSetUp();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(prevProps.filtered.length!==this.props.filtered.length){this.initialSetUp();}}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"p\",{children:this.props.reward.category}),/*#__PURE__*/_jsx(\"img\",{src:this.state.favorite?'./images/favorite1.png':'./images/unfavorite1.png',onClick:this.toggleFavorite,alt:\"favorite\"})]}),/*#__PURE__*/_jsx(\"h3\",{children:this.props.reward.name}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"p\",{children:this.props.reward.description&&this.props.reward.description}),this.props.reward.url&&/*#__PURE__*/_jsx(\"a\",{href:\"{this.props.reward.url}\",children:\"Link\"})]},this.props.reward._id);}}]);return OneReward;}(Component);export{OneReward as default};","map":{"version":3,"sources":["/Users/markkeeble/Ironhack/course/30-day-streak/client/src/components/rewards/OneReward.js"],"names":["React","Component","axios","OneReward","state","favorite","toggleFavorite","newFavorite","setState","rewardID","props","reward","_id","put","updatedUser","console","log","data","setUser","user","getData","initialSetUp","foundInUserFavorites","rewards","some","prevProps","prevState","filtered","length","category","name","description","url"],"mappings":"mlCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,8BAAP,C,GAEqBC,CAAAA,S,uUACnBC,K,CAAQ,CACNC,QAAQ,CAAE,EADJ,C,OAIRC,c,sEAAiB,wLAEPC,WAFO,CAEO,CAAC,MAAKH,KAAL,CAAWC,QAFnB,CAIb;AACA;AACA,MAAKG,QAAL,CAAc,CAAEH,QAAQ,CAAEE,WAAZ,CAAd,EACA;AACME,QARO,CAQI,MAAKC,KAAL,CAAWC,MAAX,CAAkBC,GARtB,CASb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AA3Ba,sBA6BaV,CAAAA,KAAK,CAACW,GAAN,sBACVJ,QADU,qBAExB,CACEJ,QAAQ,CAAEE,WADZ,CAFwB,CA7Bb,QA6BPO,WA7BO,eAmCbC,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BF,WAAW,CAACG,IAAvC,EACA,MAAKP,KAAL,CAAWQ,OAAX,CAAmBJ,WAAW,CAACG,IAA/B,EACAF,OAAO,CAACC,GAAR,CAAY,yBAAZ,CAAuC,MAAKN,KAAL,CAAWS,IAAlD,EACA;AACA,MAAKT,KAAL,CAAWU,OAAX,GAvCa,iFAyCbL,OAAO,CAACC,GAAR,cAzCa,qE,SA6CjBK,Y,CAAe,UAAM,CACnB,GAAMC,CAAAA,oBAAoB,CAAG,MAAKZ,KAAL,CAAWS,IAAX,CAAgBI,OAAhB,CAAwBC,IAAxB,CAA6B,SAACb,MAAD,CAAY,CACpE,MAAOA,CAAAA,MAAM,CAACC,GAAP,GAAe,MAAKF,KAAL,CAAWC,MAAX,CAAkBC,GAAxC,CACD,CAF4B,CAA7B,CAIA,MAAKJ,QAAL,CAAc,CACZH,QAAQ,CAAEiB,oBADE,CAAd,EAGD,C,kGAEmB,CAClB,KAAKD,YAAL,GACD,C,8DAEkBI,S,CAAWC,S,CAAW,CACvC,GAAID,SAAS,CAACE,QAAV,CAAmBC,MAAnB,GAA8B,KAAKlB,KAAL,CAAWiB,QAAX,CAAoBC,MAAtD,CAA8D,CAC5D,KAAKP,YAAL,GACD,CACF,C,uCAEQ,CACP,mBACE,aAAK,SAAS,CAAC,MAAf,wBACE,aAAK,SAAS,CAAC,aAAf,wBACE,mBAAI,KAAKX,KAAL,CAAWC,MAAX,CAAkBkB,QAAtB,EADF,cAEE,YACE,GAAG,CACD,KAAKzB,KAAL,CAAWC,QAAX,CACI,wBADJ,CAEI,0BAJR,CAME,OAAO,CAAE,KAAKC,cANhB,CAOE,GAAG,CAAC,UAPN,EAFF,GADF,cAaE,oBAAK,KAAKI,KAAL,CAAWC,MAAX,CAAkBmB,IAAvB,EAbF,cAcE,aAdF,cAeE,mBAAI,KAAKpB,KAAL,CAAWC,MAAX,CAAkBoB,WAAlB,EAAiC,KAAKrB,KAAL,CAAWC,MAAX,CAAkBoB,WAAvD,EAfF,CAiBG,KAAKrB,KAAL,CAAWC,MAAX,CAAkBqB,GAAlB,eAAyB,UAAG,IAAI,CAAC,yBAAR,kBAjB5B,GAA2B,KAAKtB,KAAL,CAAWC,MAAX,CAAkBC,GAA7C,CADF,CAqBD,C,uBA5FoCX,S,SAAlBE,S","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport '../challenges/Challenges.css';\n\nexport default class OneReward extends Component {\n  state = {\n    favorite: '',\n  };\n\n  toggleFavorite = async () => {\n    try {\n      const newFavorite = !this.state.favorite;\n\n      // 1. via Apps.js\n      // this.props.toggleFavoriteReward(this.props.reward._id, newFavorite);\n      this.setState({ favorite: newFavorite });\n      // 2. the way it's done with challenges / different route\n      const rewardID = this.props.reward._id;\n      // 3. toggleFavoriteReward but moved from App.js\n      // const updatedUser = this.props.user;\n      // console.log('newFavorite', newFavorite)\n      // console.log('user', updatedUser.rewards)\n      // if (newFavorite) updatedUser.rewards.push(this.props.reward._id);\n      // else {\n      //   updatedUser.rewards = updatedUser.rewards.filter(profileRewardId => {\n      //     console.log(profileRewardId._id, this.props.reward._id, profileRewardId._id !== this.props.reward._id)\n      //     return profileRewardId._id !== this.props.reward._id\n      //   });\n      //   console.log('updated user', updatedUser.rewards)\n      //   // updatedUser.rewards.pop(this.props.reward._id);\n      // }\n      // this.props.setUser(updatedUser);\n      // axios.put(`/users/${updatedUser._id}`, {\n      //   rewards: updatedUser.rewards\n      // })\n\n      //update state\n\n      const updatedUser = await axios.put(\n        `/api/users/${rewardID}/rewardsfavorite`,\n        {\n          favorite: newFavorite,\n        }\n      );\n      console.log('udpatedUser', updatedUser.data);\n      this.props.setUser(updatedUser.data)\n      console.log('user after set new user', this.props.user);\n      // refresh data\n      this.props.getData();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  initialSetUp = () => {\n    const foundInUserFavorites = this.props.user.rewards.some((reward) => {\n      return reward._id === this.props.reward._id;\n    });\n\n    this.setState({\n      favorite: foundInUserFavorites,\n    });\n  };\n\n  componentDidMount() {\n    this.initialSetUp();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.filtered.length !== this.props.filtered.length) {\n      this.initialSetUp();\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"card\" key={this.props.reward._id}>\n        <div className=\"card-header\">\n          <p>{this.props.reward.category}</p>\n          <img\n            src={\n              this.state.favorite\n                ? './images/favorite1.png'\n                : './images/unfavorite1.png'\n            }\n            onClick={this.toggleFavorite}\n            alt=\"favorite\"\n          />\n        </div>\n        <h3>{this.props.reward.name}</h3>\n        <hr />\n        <p>{this.props.reward.description && this.props.reward.description}</p>\n\n        {this.props.reward.url && <a href=\"{this.props.reward.url}\">Link</a>}\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
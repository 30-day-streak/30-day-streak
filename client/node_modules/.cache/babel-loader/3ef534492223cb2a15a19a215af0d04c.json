{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/markkeeble/Ironhack/course/30-day-streak/client/src/components/challenges/StartChallenge.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Challenges from './Challenges';\nimport { Redirect } from 'react-router-dom';\nexport default class StartChallenge extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      title: '',\n      goal: '',\n      dailyTargetDescription: '',\n      dailyTargetNumber: '',\n      dailyTargetUnit: '',\n      prize: '',\n      user: ''\n    };\n\n    this.handleChange = event => {\n      const name = event.target.name;\n      const value = event.target.value;\n      this.setState({\n        [name]: value\n      }); // console.log(this.state);\n    };\n\n    this.getData = () => {\n      const challengeId = this.props.match.params.id; // console.log('id from request',id);\n\n      axios.get(`/challenges/${challengeId}`).then(response => {\n        this.setState({\n          title: response.data.title,\n          goal: response.data.goal,\n          dailyTargetDescription: response.data.dailyTarget.description,\n          dailyTargetNumber: response.data.dailyTarget.number,\n          dailyTargetUnit: response.data.dailyTarget.unit\n        });\n      }).catch(err => {\n        console.log('error', err);\n      });\n    };\n\n    this.componentDidMount = () => {\n      this.getData();\n      this.setState({\n        user: this.props.user\n      });\n    };\n\n    this.handleSubmit = async event => {\n      event.preventDefault();\n      let userId = this.state.user._id;\n      const challengeId = this.props.match.params.id;\n\n      try {\n        let user = this.props.user;\n        const alreadyInUser = user.challenges.some(challenge => {\n          return challenge.id._id === challengeId;\n        });\n\n        if (alreadyInUser) {\n          user = user.challenges.map(challenge => {\n            if (challenge.id._id === challengeId) {\n              // console.log('match');\n              // console.log('challenge.status', challenge.status);\n              challenge.status = 'active';\n              challenge.startDate = new Date();\n              challenge.tracker = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n              challenge.grandPrize = this.state.prize;\n              challenge.subGoals7DayStreak = false;\n              challenge.subGoals21DayStreak = false;\n            } // console.log('challenge after update', challenge);\n\n\n            return challenge;\n          });\n        } else {\n          user.challenges.unshift({\n            id: this.props.match.params.id,\n            status: 'active',\n            tracker: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            startDate: new Date(),\n            grandPrize: this.state.prize\n          });\n        }\n\n        this.setState({\n          user: this.props.user\n        });\n        console.log('user challlenges after set state', this.state.user.challenges);\n        console.log('user rewards after set state', this.state.user.rewards);\n        const updatedUser = await axios.put(`/users/${userId}`, {\n          challenges: this.state.user.challenges,\n          rewards: this.state.user.rewards\n        });\n        const {\n          history\n        } = this.props;\n        history.push('/');\n      } catch (error) {\n        console.log(error);\n      }\n    };\n  }\n\n  render() {\n    // console.log('user from state in render', this.state.user);\n    // console.log('user from the props in render', this.props.user);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"start-challenge-page\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"start-challenge-page-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Congratulations!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Here is the information for the CHALLENGE you're starting TODAY!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: this.state.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Goal: \", this.state.goal]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Daily target: \", this.state.dailyTargetDescription, ' ', this.state.dailyTargetNumber, \" \", this.state.dailyTargetUnit]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Pick your GRAND PRIZE for completing it\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: this.handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"prize\",\n            children: \"Prize\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            id: \"prize\",\n            name: \"prize\",\n            value: this.state.prize,\n            onChange: this.handleChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            onSubmit: this.handleSubmit,\n            children: \"Let's do it!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/markkeeble/Ironhack/course/30-day-streak/client/src/components/challenges/StartChallenge.js"],"names":["React","Component","axios","Challenges","Redirect","StartChallenge","state","title","goal","dailyTargetDescription","dailyTargetNumber","dailyTargetUnit","prize","user","handleChange","event","name","target","value","setState","getData","challengeId","props","match","params","id","get","then","response","data","dailyTarget","description","number","unit","catch","err","console","log","componentDidMount","handleSubmit","preventDefault","userId","_id","alreadyInUser","challenges","some","challenge","map","status","startDate","Date","tracker","grandPrize","subGoals7DayStreak","subGoals21DayStreak","unshift","rewards","updatedUser","put","history","push","error","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Challenges from './Challenges';\nimport  { Redirect } from 'react-router-dom'\n\n\nexport default class StartChallenge extends Component {\n  state = {\n    title: '',\n    goal: '',\n    dailyTargetDescription: '',\n    dailyTargetNumber: '',\n    dailyTargetUnit: '',\n    prize: '',\n    user: '',\n  };\n\n  handleChange = (event) => {\n    const name = event.target.name;\n    const value = event.target.value;\n    this.setState({\n      [name]: value,\n    });\n    // console.log(this.state);\n  };\n\n  getData = () => {\n    const challengeId = this.props.match.params.id;\n    // console.log('id from request',id);\n    axios\n      .get(`/challenges/${challengeId}`)\n      .then((response) => {\n        this.setState({\n          title: response.data.title,\n          goal: response.data.goal,\n          dailyTargetDescription: response.data.dailyTarget.description,\n          dailyTargetNumber: response.data.dailyTarget.number,\n          dailyTargetUnit: response.data.dailyTarget.unit,\n        });\n      })\n      .catch((err) => {\n        console.log('error', err);\n      });\n  };\n\n  // activate this with get data\n  componentDidMount = () => {\n    this.getData();\n    this.setState({\n      user: this.props.user,\n    });\n  };\n\n  handleSubmit = async (event) => {\n    event.preventDefault();\n    let userId = this.state.user._id;\n    const challengeId = this.props.match.params.id;\n    try {\n      let user = this.props.user;\n      const alreadyInUser = user.challenges.some((challenge) => {\n        return challenge.id._id === challengeId;\n      });\n      if (alreadyInUser) {\n        user = user.challenges.map((challenge) => {\n          if (challenge.id._id === challengeId) {\n            // console.log('match');\n            // console.log('challenge.status', challenge.status);\n            challenge.status = 'active';\n            challenge.startDate = new Date();\n            challenge.tracker = [\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n            ];\n            challenge.grandPrize = this.state.prize\n            challenge.subGoals7DayStreak = false;\n            challenge.subGoals21DayStreak = false;\n          }\n          // console.log('challenge after update', challenge);\n          return challenge;\n        });\n      } else {\n        user.challenges.unshift({\n          id: this.props.match.params.id,\n          status: 'active',\n          tracker: [\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n          ],\n          startDate: new Date(),\n          grandPrize: this.state.prize\n        });\n      }\n      this.setState({\n        user: this.props.user,\n      });\n      console.log('user challlenges after set state', this.state.user.challenges);\n      console.log('user rewards after set state', this.state.user.rewards);\n\n\n      const updatedUser = await axios.put(`/users/${userId}`, {\n        challenges: this.state.user.challenges,\n        rewards: this.state.user.rewards,\n      });\n      const {history} = this.props\n      history.push('/');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  render() {\n    // console.log('user from state in render', this.state.user);\n    // console.log('user from the props in render', this.props.user);\n    return (\n      <div className=\"start-challenge-page\">\n        <div className=\"start-challenge-page-content\">\n          <h1>Congratulations!</h1>\n          <h2>\n            Here is the information for the CHALLENGE you're starting TODAY!\n          </h2>\n          <h3>{this.state.title}</h3>\n          <p>Goal: {this.state.goal}</p>\n          <p>\n            Daily target: {this.state.dailyTargetDescription}{' '}\n            {this.state.dailyTargetNumber} {this.state.dailyTargetUnit}\n          </p>\n          <h2>Pick your GRAND PRIZE for completing it</h2>\n          <form onSubmit={this.handleSubmit}>\n            <label htmlFor=\"prize\">Prize</label>\n            <input\n              type=\"text\"\n              id=\"prize\"\n              name=\"prize\"\n              value={this.state.prize}\n              onChange={this.handleChange}\n              required\n            />\n            <button type=\"submit\" onSubmit={this.handleSubmit}>\n              Let's do it!\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
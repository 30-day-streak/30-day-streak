{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/markkeeble/Ironhack/course/30-day-streak/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import axios from'axios';import'./Challenges.css';var StartChallenge=/*#__PURE__*/function(_Component){_inherits(StartChallenge,_Component);var _super=_createSuper(StartChallenge);function StartChallenge(){var _this;_classCallCheck(this,StartChallenge);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={title:'',goal:'',dailyTargetDescription:'',dailyTargetNumber:'',dailyTargetUnit:'',prize:'',user:''};_this.handleChange=function(event){var name=event.target.name;var value=event.target.value;_this.setState(_defineProperty({},name,value));};_this.getData=function(){var challengeId=_this.props.match.params.id;axios.get(\"/api/challenges/\".concat(challengeId)).then(function(response){_this.setState({title:response.data.title,goal:response.data.goal,dailyTargetDescription:response.data.dailyTarget.description,dailyTargetNumber:response.data.dailyTarget.number,dailyTargetUnit:response.data.dailyTarget.unit});}).catch(function(err){console.log('error',err);});};_this.componentDidMount=function(){_this.getData();_this.setState({user:_this.props.user});};_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var userId,challengeId,user,alreadyInUser,updatedUser,history;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();userId=_this.state.user._id;challengeId=_this.props.match.params.id;_context.prev=3;user=_this.props.user;alreadyInUser=user.challenges.some(function(challenge){return challenge.id._id===challengeId;});if(alreadyInUser){user=user.challenges.map(function(challenge){if(challenge.id._id===challengeId){challenge.status='active';challenge.startDate=new Date();challenge.tracker=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];challenge.grandPrize=_this.state.prize;}return challenge;});}else{user.challenges.unshift({id:_this.props.match.params.id,status:'active',tracker:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],startDate:new Date(),grandPrize:_this.state.prize});}_this.setState({user:_this.props.user});_context.next=10;return axios.put(\"/api/users/\".concat(userId),{challenges:_this.state.user.challenges,rewards:_this.state.user.rewards});case 10:updatedUser=_context.sent;console.log('updatedUser.data',updatedUser.data);_this.props.setUser(updatedUser.data);// let updatedUser = await axios.get('/auth/loggedin')\nhistory=_this.props.history;history.push('/');_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](3);console.log(_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[3,17]]);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(StartChallenge,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(\"div\",{className:\"start-challenge-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"start-challenge-page-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Congratulations!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Here is the information for the CHALLENGE you're starting TODAY!\"}),/*#__PURE__*/_jsx(\"h3\",{children:this.state.title}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Goal: \",this.state.goal]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Daily target: \",this.state.dailyTargetDescription,' ',this.state.dailyTargetNumber,\" \",this.state.dailyTargetUnit]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Pick your GRAND PRIZE for completing it\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"prize\",children:\"Prize\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"prize\",name:\"prize\",value:this.state.prize,onChange:this.handleChange,required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"button-dark\",type:\"submit\",onSubmit:this.handleSubmit,children:\"Let's do it!\"})]})]})});}}]);return StartChallenge;}(Component);export{StartChallenge as default};","map":{"version":3,"sources":["/Users/markkeeble/Ironhack/course/30-day-streak/client/src/components/challenges/StartChallenge.js"],"names":["React","Component","axios","StartChallenge","state","title","goal","dailyTargetDescription","dailyTargetNumber","dailyTargetUnit","prize","user","handleChange","event","name","target","value","setState","getData","challengeId","props","match","params","id","get","then","response","data","dailyTarget","description","number","unit","catch","err","console","log","componentDidMount","handleSubmit","preventDefault","userId","_id","alreadyInUser","challenges","some","challenge","map","status","startDate","Date","tracker","grandPrize","unshift","put","rewards","updatedUser","setUser","history","push"],"mappings":"kwCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,kBAAP,C,GAGqBC,CAAAA,c,2VACnBC,K,CAAQ,CACNC,KAAK,CAAE,EADD,CAENC,IAAI,CAAE,EAFA,CAGNC,sBAAsB,CAAE,EAHlB,CAINC,iBAAiB,CAAE,EAJb,CAKNC,eAAe,CAAE,EALX,CAMNC,KAAK,CAAE,EAND,CAONC,IAAI,CAAE,EAPA,C,OAURC,Y,CAAe,SAACC,KAAD,CAAW,CACxB,GAAMC,CAAAA,IAAI,CAAGD,KAAK,CAACE,MAAN,CAAaD,IAA1B,CACA,GAAME,CAAAA,KAAK,CAAGH,KAAK,CAACE,MAAN,CAAaC,KAA3B,CACA,MAAKC,QAAL,oBACGH,IADH,CACUE,KADV,GAGD,C,OAEDE,O,CAAU,UAAM,CACd,GAAMC,CAAAA,WAAW,CAAG,MAAKC,KAAL,CAAWC,KAAX,CAAiBC,MAAjB,CAAwBC,EAA5C,CACArB,KAAK,CACFsB,GADH,2BAC0BL,WAD1B,GAEGM,IAFH,CAEQ,SAACC,QAAD,CAAc,CAClB,MAAKT,QAAL,CAAc,CACZZ,KAAK,CAAEqB,QAAQ,CAACC,IAAT,CAActB,KADT,CAEZC,IAAI,CAAEoB,QAAQ,CAACC,IAAT,CAAcrB,IAFR,CAGZC,sBAAsB,CAAEmB,QAAQ,CAACC,IAAT,CAAcC,WAAd,CAA0BC,WAHtC,CAIZrB,iBAAiB,CAAEkB,QAAQ,CAACC,IAAT,CAAcC,WAAd,CAA0BE,MAJjC,CAKZrB,eAAe,CAAEiB,QAAQ,CAACC,IAAT,CAAcC,WAAd,CAA0BG,IAL/B,CAAd,EAOD,CAVH,EAWGC,KAXH,CAWS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CAbH,EAcD,C,OAGDG,iB,CAAoB,UAAM,CACxB,MAAKlB,OAAL,GACA,MAAKD,QAAL,CAAc,CACZN,IAAI,CAAE,MAAKS,KAAL,CAAWT,IADL,CAAd,EAGD,C,OAED0B,Y,0FAAe,iBAAOxB,KAAP,gLACbA,KAAK,CAACyB,cAAN,GACIC,MAFS,CAEA,MAAKnC,KAAL,CAAWO,IAAX,CAAgB6B,GAFhB,CAGPrB,WAHO,CAGO,MAAKC,KAAL,CAAWC,KAAX,CAAiBC,MAAjB,CAAwBC,EAH/B,iBAKPZ,IALO,CAKA,MAAKS,KAAL,CAAWT,IALX,CAML8B,aANK,CAMW9B,IAAI,CAAC+B,UAAL,CAAgBC,IAAhB,CAAqB,SAACC,SAAD,CAAe,CACxD,MAAOA,CAAAA,SAAS,CAACrB,EAAV,CAAaiB,GAAb,GAAqBrB,WAA5B,CACD,CAFqB,CANX,CASX,GAAIsB,aAAJ,CAAmB,CACjB9B,IAAI,CAAGA,IAAI,CAAC+B,UAAL,CAAgBG,GAAhB,CAAoB,SAACD,SAAD,CAAe,CACxC,GAAIA,SAAS,CAACrB,EAAV,CAAaiB,GAAb,GAAqBrB,WAAzB,CAAsC,CACpCyB,SAAS,CAACE,MAAV,CAAmB,QAAnB,CACAF,SAAS,CAACG,SAAV,CAAsB,GAAIC,CAAAA,IAAJ,EAAtB,CACAJ,SAAS,CAACK,OAAV,CAAoB,CAClB,CADkB,CAElB,CAFkB,CAGlB,CAHkB,CAIlB,CAJkB,CAKlB,CALkB,CAMlB,CANkB,CAOlB,CAPkB,CAQlB,CARkB,CASlB,CATkB,CAUlB,CAVkB,CAWlB,CAXkB,CAYlB,CAZkB,CAalB,CAbkB,CAclB,CAdkB,CAelB,CAfkB,CAgBlB,CAhBkB,CAiBlB,CAjBkB,CAkBlB,CAlBkB,CAmBlB,CAnBkB,CAoBlB,CApBkB,CAqBlB,CArBkB,CAsBlB,CAtBkB,CAuBlB,CAvBkB,CAwBlB,CAxBkB,CAyBlB,CAzBkB,CA0BlB,CA1BkB,CA2BlB,CA3BkB,CA4BlB,CA5BkB,CA6BlB,CA7BkB,CA8BlB,CA9BkB,CAApB,CAgCAL,SAAS,CAACM,UAAV,CAAuB,MAAK9C,KAAL,CAAWM,KAAlC,CACD,CACD,MAAOkC,CAAAA,SAAP,CACD,CAvCM,CAAP,CAwCD,CAzCD,IAyCO,CACLjC,IAAI,CAAC+B,UAAL,CAAgBS,OAAhB,CAAwB,CACtB5B,EAAE,CAAE,MAAKH,KAAL,CAAWC,KAAX,CAAiBC,MAAjB,CAAwBC,EADN,CAEtBuB,MAAM,CAAE,QAFc,CAGtBG,OAAO,CAAE,CACP,CADO,CAEP,CAFO,CAGP,CAHO,CAIP,CAJO,CAKP,CALO,CAMP,CANO,CAOP,CAPO,CAQP,CARO,CASP,CATO,CAUP,CAVO,CAWP,CAXO,CAYP,CAZO,CAaP,CAbO,CAcP,CAdO,CAeP,CAfO,CAgBP,CAhBO,CAiBP,CAjBO,CAkBP,CAlBO,CAmBP,CAnBO,CAoBP,CApBO,CAqBP,CArBO,CAsBP,CAtBO,CAuBP,CAvBO,CAwBP,CAxBO,CAyBP,CAzBO,CA0BP,CA1BO,CA2BP,CA3BO,CA4BP,CA5BO,CA6BP,CA7BO,CA8BP,CA9BO,CAHa,CAmCtBF,SAAS,CAAE,GAAIC,CAAAA,IAAJ,EAnCW,CAoCtBE,UAAU,CAAE,MAAK9C,KAAL,CAAWM,KApCD,CAAxB,EAsCD,CACD,MAAKO,QAAL,CAAc,CACZN,IAAI,CAAE,MAAKS,KAAL,CAAWT,IADL,CAAd,EA1FW,uBA6FeT,CAAAA,KAAK,CAACkD,GAAN,sBAAwBb,MAAxB,EAAkC,CAC1DG,UAAU,CAAE,MAAKtC,KAAL,CAAWO,IAAX,CAAgB+B,UAD8B,CAE1DW,OAAO,CAAE,MAAKjD,KAAL,CAAWO,IAAX,CAAgB0C,OAFiC,CAAlC,CA7Ff,SA6FLC,WA7FK,eAiGXpB,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAAgCmB,WAAW,CAAC3B,IAA5C,EACA,MAAKP,KAAL,CAAWmC,OAAX,CAAmBD,WAAW,CAAC3B,IAA/B,EACA;AACO6B,OApGI,CAoGO,MAAKpC,KApGZ,CAoGJoC,OApGI,CAqGXA,OAAO,CAACC,IAAR,CAAa,GAAb,EArGW,iFAuGXvB,OAAO,CAACC,GAAR,cAvGW,qE,+IA2GN,CACP,mBACE,YAAK,SAAS,CAAC,sBAAf,uBACE,aAAK,SAAS,CAAC,8BAAf,wBACE,wCADF,cAEE,uFAFF,cAKE,oBAAK,KAAK/B,KAAL,CAAWC,KAAhB,EALF,cAME,8BAAU,KAAKD,KAAL,CAAWE,IAArB,GANF,cAOE,sCACiB,KAAKF,KAAL,CAAWG,sBAD5B,CACoD,GADpD,CAEG,KAAKH,KAAL,CAAWI,iBAFd,KAEkC,KAAKJ,KAAL,CAAWK,eAF7C,GAPF,cAWE,+DAXF,cAYE,cAAM,QAAQ,CAAE,KAAK4B,YAArB,wBACE,cAAO,OAAO,CAAC,OAAf,mBADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,OAFL,CAGE,IAAI,CAAC,OAHP,CAIE,KAAK,CAAE,KAAKjC,KAAL,CAAWM,KAJpB,CAKE,QAAQ,CAAE,KAAKE,YALjB,CAME,QAAQ,KANV,EAFF,cAUE,eAAQ,SAAS,CAAC,aAAlB,CAAgC,IAAI,CAAC,QAArC,CAA8C,QAAQ,CAAE,KAAKyB,YAA7D,0BAVF,GAZF,GADF,EADF,CA+BD,C,4BAxLyCpC,S,SAAvBE,c","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport './Challenges.css'\n\n\nexport default class StartChallenge extends Component {\n  state = {\n    title: '',\n    goal: '',\n    dailyTargetDescription: '',\n    dailyTargetNumber: '',\n    dailyTargetUnit: '',\n    prize: '',\n    user: '',\n  };\n\n  handleChange = (event) => {\n    const name = event.target.name;\n    const value = event.target.value;\n    this.setState({\n      [name]: value,\n    });\n  };\n\n  getData = () => {\n    const challengeId = this.props.match.params.id;\n    axios\n      .get(`/api/challenges/${challengeId}`)\n      .then((response) => {\n        this.setState({\n          title: response.data.title,\n          goal: response.data.goal,\n          dailyTargetDescription: response.data.dailyTarget.description,\n          dailyTargetNumber: response.data.dailyTarget.number,\n          dailyTargetUnit: response.data.dailyTarget.unit,\n        });\n      })\n      .catch((err) => {\n        console.log('error', err);\n      });\n  };\n\n  // activate this with get data\n  componentDidMount = () => {\n    this.getData();\n    this.setState({\n      user: this.props.user,\n    });\n  };\n\n  handleSubmit = async (event) => {\n    event.preventDefault();\n    let userId = this.state.user._id;\n    const challengeId = this.props.match.params.id;\n    try {\n      let user = this.props.user;\n      const alreadyInUser = user.challenges.some((challenge) => {\n        return challenge.id._id === challengeId;\n      });\n      if (alreadyInUser) {\n        user = user.challenges.map((challenge) => {\n          if (challenge.id._id === challengeId) {\n            challenge.status = 'active';\n            challenge.startDate = new Date();\n            challenge.tracker = [\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n            ];\n            challenge.grandPrize = this.state.prize;\n          }\n          return challenge;\n        });\n      } else {\n        user.challenges.unshift({\n          id: this.props.match.params.id,\n          status: 'active',\n          tracker: [\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n            0,\n          ],\n          startDate: new Date(),\n          grandPrize: this.state.prize\n        });\n      }\n      this.setState({\n        user: this.props.user,\n      });\n      const updatedUser = await axios.put(`/api/users/${userId}`, {\n        challenges: this.state.user.challenges,\n        rewards: this.state.user.rewards,\n      });\n      console.log('updatedUser.data', updatedUser.data);\n      this.props.setUser(updatedUser.data)\n      // let updatedUser = await axios.get('/auth/loggedin')\n      const {history} = this.props\n      history.push('/');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"start-challenge-page\">\n        <div className=\"start-challenge-page-content\">\n          <h1>Congratulations!</h1>\n          <p>\n            Here is the information for the CHALLENGE you're starting TODAY!\n          </p>\n          <h3>{this.state.title}</h3>\n          <p>Goal: {this.state.goal}</p>\n          <p>\n            Daily target: {this.state.dailyTargetDescription}{' '}\n            {this.state.dailyTargetNumber} {this.state.dailyTargetUnit}\n          </p>\n          <h2>Pick your GRAND PRIZE for completing it</h2>\n          <form onSubmit={this.handleSubmit}>\n            <label htmlFor=\"prize\">Prize</label>\n            <input\n              type=\"text\"\n              id=\"prize\"\n              name=\"prize\"\n              value={this.state.prize}\n              onChange={this.handleChange}\n              required\n            />\n            <button className=\"button-dark\" type=\"submit\" onSubmit={this.handleSubmit}>\n              Let's do it!\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}